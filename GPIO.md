# GPIO（通用输入输出）工作原理解析

## 一、GPIO 的基本概念

GPIO（General Purpose Input/Output）是 MCU 上可编程控制的数字引脚，可通过软件配置为输入模式或输出模式，用于连接外部设备（如 LED、按键、传感器等）。

**关键特性**：
- **双向控制**：支持输入（读取外部信号）和输出（驱动外部设备）。
- **多模式配置**：如推挽输出、开漏输出、上拉输入等。
- **灵活的电平控制**：输出高电平（如 3.3V）或低电平（0V）。

## 二、GPIO 的工作模式

### 1. 输入模式

- **浮空输入（Floating Input）**
    - 引脚直接连接至内部电路，无上下拉电阻。
    - 应用场景：外部信号已包含明确的高低电平（如数字传感器输出）。
    - 注意：悬空时电平可能不稳定，需外部电路确保信号明确。

- **上拉输入（Pull-Up Input）**
    - 内部通过电阻连接至 VCC，默认电平为高。
    - 应用场景：检测低电平触发事件（如按键按下接地）。
    - 电路示意：
    ```plaintext
    VCC
     |
  Resistor
     |
  GPIO引脚 → 外部信号
    ```

- **下拉输入（Pull-Down Input）**
    - 内部通过电阻连接至 GND，默认电平为低。
    - 应用场景：检测高电平触发事件（如按键按下接 VCC）。

### 2. 输出模式

- **推挽输出（Push-Pull Output）**
    - 电路结构：由两个互补的 MOS 管组成，可主动输出高或低电平。
    - 特点：驱动能力强，高低电平切换速度快。
    - 应用场景：驱动 LED、继电器等需要明确电平的设备。

- **开漏输出（Open-Drain Output）**
    - 电路结构：仅有一个下拉 MOS 管，高电平需外部上拉电阻。
    - 特点：支持“线与”逻辑，多个开漏引脚可共享总线。
    - 应用场景：I2C 总线、电平转换（如 5V 与 3.3V 设备通信）。

### 模拟输入，复用推挽输出，复用开漏输出

## 三、GPIO 的工作流程

### 1. 输入模式工作流程

```plaintext
外部信号 → GPIO引脚 → 输入缓冲器 → 读取 IDR 寄存器 → 软件处理
